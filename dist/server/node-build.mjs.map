{"version":3,"file":"node-build.mjs","sources":["../../server/routes/demo.ts","../../server/routes/signup.ts","../../server/routes/chat.ts","../../server/routes/webhook.ts","../../server/index.ts","../../server/node-build.ts"],"sourcesContent":["import { RequestHandler } from \"express\";\nimport { DemoResponse } from \"@shared/api\";\n\nexport const handleDemo: RequestHandler = (req, res) => {\n  const response: DemoResponse = {\n    message: \"Hello from Express server\",\n  };\n  res.status(200).json(response);\n};\n","import { RequestHandler } from \"express\";\n\ninterface SignupRequest {\n  name: string;\n  email: string;\n  password: string;\n  confirmPassword: string;\n  age: string;\n  gender: string;\n}\n\nexport const handleSignup: RequestHandler = async (req, res) => {\n  const { name, email, password, confirmPassword, age, gender } = req.body as SignupRequest;\n\n  // Validation\n  if (!name || !email || !password || !confirmPassword || !age || !gender) {\n    res.status(400).json({ error: \"Missing required fields\" });\n    return;\n  }\n\n  if (password !== confirmPassword) {\n    res.status(400).json({ error: \"Passwords do not match\" });\n    return;\n  }\n\n  if (password.length < 8) {\n    res.status(400).json({ error: \"Password must be at least 8 characters\" });\n    return;\n  }\n\n  const ageNum = parseInt(age);\n  if (isNaN(ageNum) || ageNum < 13) {\n    res.status(400).json({ error: \"You must be at least 13 years old\" });\n    return;\n  }\n\n  // Simulate API delay\n  await new Promise((resolve) => setTimeout(resolve, 500));\n\n  // Dummy signup success response\n  res.status(200).json({\n    success: true,\n    message: \"Account created successfully\",\n    user: {\n      id: Math.random().toString(36).substr(2, 9),\n      name,\n      email,\n      age: ageNum,\n      gender,\n      createdAt: new Date().toISOString(),\n    },\n  });\n};\n","import { RequestHandler } from \"express\";\n\ninterface ChatRequest {\n  message: string;\n  conversationId: string;\n}\n\n// Dummy responses based on message keywords\nconst getDummyResponse = (message: string): string => {\n  const lowerMessage = message.toLowerCase();\n\n  if (\n    lowerMessage.includes(\"hello\") ||\n    lowerMessage.includes(\"hi\") ||\n    lowerMessage.includes(\"hey\")\n  ) {\n    return \"Hello! ðŸ‘‹ How can I assist you today? Feel free to ask me anything!\";\n  }\n\n  if (\n    lowerMessage.includes(\"how are you\") ||\n    lowerMessage.includes(\"how do you feel\")\n  ) {\n    return \"I'm doing great, thanks for asking! I'm here and ready to help with whatever you need. What would you like to discuss?\";\n  }\n\n  if (\n    lowerMessage.includes(\"help\") ||\n    lowerMessage.includes(\"can you\")\n  ) {\n    return \"Of course! I'd be happy to help. I can assist you with various tasks like answering questions, writing, coding, brainstorming, and much more. What do you need help with?\";\n  }\n\n  if (\n    lowerMessage.includes(\"python\") ||\n    lowerMessage.includes(\"javascript\") ||\n    lowerMessage.includes(\"code\") ||\n    lowerMessage.includes(\"programming\")\n  ) {\n    return \"Great! I'm well-versed in programming. Whether you need help with Python, JavaScript, or other languages, I can assist with explanations, debugging, or writing code. What's your programming question?\";\n  }\n\n  if (\n    lowerMessage.includes(\"write\") ||\n    lowerMessage.includes(\"essay\") ||\n    lowerMessage.includes(\"story\")\n  ) {\n    return \"I'd love to help with your writing! Whether it's an essay, story, or creative piece, I can help you brainstorm, draft, or refine your ideas. What would you like to write about?\";\n  }\n\n  if (\n    lowerMessage.includes(\"joke\") ||\n    lowerMessage.includes(\"funny\") ||\n    lowerMessage.includes(\"laugh\")\n  ) {\n    return \"Why did the AI go to school? To improve its learning model! ðŸ˜„ Got any other requests? I can help with humor or anything else you need.\";\n  }\n\n  if (\n    lowerMessage.includes(\"thank\") ||\n    lowerMessage.includes(\"thanks\") ||\n    lowerMessage.includes(\"appreciate\")\n  ) {\n    return \"You're welcome! I'm happy to help. Don't hesitate to ask if you need anything else!\";\n  }\n\n  if (\n    lowerMessage.includes(\"what\") ||\n    lowerMessage.includes(\"tell me about\") ||\n    lowerMessage.includes(\"explain\")\n  ) {\n    return \"I'd be happy to explain that! I can provide information on almost any topic. Could you be more specific about what you'd like to know?\";\n  }\n\n  if (lowerMessage.includes(\"bye\") || lowerMessage.includes(\"goodbye\")) {\n    return \"Goodbye! It was great chatting with you. Feel free to come back anytime if you need help. Have a wonderful day! ðŸ‘‹\";\n  }\n\n  // Default response for any other message\n  return `That's an interesting question: \"${message}\". I can help you with that! Could you provide a bit more detail so I can give you the best answer? Feel free to ask anything - I'm here to help with information, creative tasks, coding, problem-solving, and much more.`;\n};\n\nexport const handleChat: RequestHandler = async (req, res) => {\n  const { message, conversationId } = req.body as ChatRequest;\n\n  if (!message || !conversationId) {\n    res.status(400).json({ error: \"Missing required fields\" });\n    return;\n  }\n\n  // Simulate API delay\n  await new Promise((resolve) => setTimeout(resolve, 800));\n\n  const response = getDummyResponse(message);\n\n  res.status(200).json({\n    success: true,\n    conversationId,\n    response,\n    timestamp: new Date().toISOString(),\n  });\n};\n","import { RequestHandler } from \"express\";\n\nconst BACKEND_BASE_URL = \"http://localhost:5678/webhook\";\n\nconst forwardRequest = async (\n  endpoint: string,\n  method: string,\n  body?: any,\n  authHeader?: string,\n) => {\n  try {\n    const headers: Record<string, string> = {\n      \"Content-Type\": \"application/json\",\n    };\n\n    // Add Authorization header if provided\n    if (authHeader) {\n      headers[\"Authorization\"] = authHeader;\n    }\n\n    const options: RequestInit = {\n      method,\n      headers,\n    };\n\n    if (body) {\n      options.body = JSON.stringify(body);\n    }\n\n    const response = await fetch(`${BACKEND_BASE_URL}${endpoint}`, options);\n    const data = await response.json();\n\n    return {\n      ok: response.ok,\n      status: response.status,\n      data,\n    };\n  } catch (error) {\n    console.error(`Error forwarding request to ${endpoint}:`, error);\n    throw error;\n  }\n};\n\nexport const handleLogin: RequestHandler = async (req, res) => {\n  try {\n    const result = await forwardRequest(\"/login\", \"POST\", req.body);\n\n    if (result.ok) {\n      res.status(result.status).json(result.data);\n    } else {\n      res.status(result.status).json(result.data);\n    }\n  } catch (error) {\n    console.error(\"Login error:\", error);\n    res.status(500).json({ error: \"Failed to process login request\" });\n  }\n};\n\nexport const handleSignUpUser: RequestHandler = async (req, res) => {\n  try {\n    const result = await forwardRequest(\"/sign-up-user\", \"POST\", req.body);\n\n    if (result.ok) {\n      res.status(result.status).json(result.data);\n    } else {\n      res.status(result.status).json(result.data);\n    }\n  } catch (error) {\n    console.error(\"Sign up error:\", error);\n    res.status(500).json({ error: \"Failed to process sign up request\" });\n  }\n};\n\nexport const handleUserDetails: RequestHandler = async (req, res) => {\n  try {\n    const authHeader = req.headers.authorization;\n    const result = await forwardRequest(\n      \"/user-details\",\n      \"GET\",\n      undefined,\n      authHeader,\n    );\n\n    if (result.ok) {\n      res.status(result.status).json(result.data);\n    } else {\n      res.status(result.status).json(result.data);\n    }\n  } catch (error) {\n    console.error(\"User details error:\", error);\n    res.status(500).json({ error: \"Failed to fetch user details\" });\n  }\n};\n\nexport const handleCreateCase: RequestHandler = async (req, res) => {\n  try {\n    const authHeader = req.headers.authorization;\n    const result = await forwardRequest(\n      \"/create-case\",\n      \"POST\",\n      req.body,\n      authHeader,\n    );\n\n    if (result.ok) {\n      res.status(result.status).json(result.data);\n    } else {\n      res.status(result.status).json(result.data);\n    }\n  } catch (error) {\n    console.error(\"Create case error:\", error);\n    res.status(500).json({ error: \"Failed to create case\" });\n  }\n};\n\nexport const handleLoadCaseConversation: RequestHandler = async (req, res) => {\n  try {\n    const authHeader = req.headers.authorization;\n    const result = await forwardRequest(\n      \"/load-case-conversation\",\n      \"POST\",\n      req.body,\n      authHeader,\n    );\n\n    if (result.ok) {\n      res.status(result.status).json(result.data);\n    } else {\n      res.status(result.status).json(result.data);\n    }\n  } catch (error) {\n    console.error(\"Load case conversation error:\", error);\n    res.status(500).json({ error: \"Failed to load case conversation\" });\n  }\n};\n\nexport const handleInitiateChat: RequestHandler = async (req, res) => {\n  try {\n    const authHeader = req.headers.authorization;\n    const result = await forwardRequest(\n      \"/initiate-chat\",\n      \"POST\",\n      req.body,\n      authHeader,\n    );\n\n    if (result.ok) {\n      res.status(result.status).json(result.data);\n    } else {\n      res.status(result.status).json(result.data);\n    }\n  } catch (error) {\n    console.error(\"Initiate chat error:\", error);\n    res.status(500).json({ error: \"Failed to initiate chat\" });\n  }\n};\n\nexport const handleAiResponse: RequestHandler = async (req, res) => {\n  try {\n    const authHeader = req.headers.authorization;\n    const result = await forwardRequest(\n      \"/ai-resp\",\n      \"POST\",\n      req.body,\n      authHeader,\n    );\n\n    if (result.ok) {\n      res.status(result.status).json(result.data);\n    } else {\n      res.status(result.status).json(result.data);\n    }\n  } catch (error) {\n    console.error(\"AI response error:\", error);\n    res.status(500).json({ error: \"Failed to get AI response\" });\n  }\n};\n","import \"dotenv/config\";\nimport express from \"express\";\nimport { fileURLToPath } from \"url\";\nimport cors from \"cors\";\nimport path from \"path\";\nimport { handleDemo } from \"./routes/demo\";\nimport { handleSignup } from \"./routes/signup\";\nimport { handleChat } from \"./routes/chat\";\nimport {\n  handleLogin,\n  handleSignUpUser,\n  handleUserDetails,\n  handleCreateCase,\n  handleLoadCaseConversation,\n  handleInitiateChat,\n  handleAiResponse,\n} from \"./routes/webhook\";\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\nexport function createServer() {\n  const app = express();\n\n  // Middleware\n  app.use(cors());\n  app.use(express.json());\n  app.use(express.urlencoded({ extended: true }));\n\n  // Example API routes\n  app.get(\"/api/ping\", (_req, res) => {\n    const ping = process.env.PING_MESSAGE ?? \"ping\";\n    res.json({ message: ping });\n  });\n\n  app.get(\"/api/demo\", handleDemo);\n\n  // Auth routes\n  app.post(\"/api/signup\", handleSignup);\n\n  // Chat routes\n  app.post(\"/api/chat\", handleChat);\n\n  // Webhook routes\n  app.post(\"/webhook/login\", handleLogin);\n  app.post(\"/webhook/sign-up-user\", handleSignUpUser);\n  app.get(\"/webhook/user-details\", handleUserDetails);\n  app.post(\"/webhook/create-case\", handleCreateCase);\n  app.post(\"/webhook/load-case-conversation\", handleLoadCaseConversation);\n  app.post(\"/webhook/initiate-chat\", handleInitiateChat);\n  app.post(\"/webhook/ai-resp\", handleAiResponse);\n\n  // SPA Fallback: Only in production mode\n  // In development, Vite's dev server handles SPA routing\n  if (process.env.NODE_ENV === \"production\") {\n    const spaDir = path.join(__dirname, \"../spa\"); // same as old working version\n    app.use(express.static(spaDir));\n\n    app.use((req, res, next) => {\n      if (req.path.startsWith(\"/api/\")) return next();\n      res.sendFile(path.join(spaDir, \"index.html\"));\n    });\n  }\n\n\n  return app;\n}\n","import path from \"path\";\nimport express from \"express\";\nimport { createServer } from \"./index\";\nimport os from \"os\";\n\nconst app = createServer();\nconst port = process.env.PORT || 3000;\n\nconst __dirname = import.meta.dirname;\nconst distPath = path.join(__dirname, \"../spa\");\n\nconst getLocalIp = () => {\n  const networkInterfaces = os.networkInterfaces();\n  for (const iface of Object.values(networkInterfaces)) {\n    for (const ifaceDetail of iface) {\n      if (ifaceDetail.family === 'IPv4' && !ifaceDetail.internal) {\n        return ifaceDetail.address;\n      }\n    }\n  }\n  return 'localhost';  // Fallback to localhost if no external IP found\n};\n\n// Serve static\napp.use(express.static(distPath));\n\n// SPA fallback using *middleware* ONLY â€” NOT routes\napp.use((req, res, next) => {\n  if (req.method !== \"GET\") return next();\n\n  // Skip API routes\n  if (req.path.startsWith(\"/api\") || req.path.startsWith(\"/health\")) {\n    return next();\n  }\n\n  // Serve index.html for React Router\n  res.sendFile(path.join(distPath, \"index.html\"));\n});\n\napp.listen(port, () => {\n  const localIp = getLocalIp();\n  console.log(`Network: http://${localIp}:${port}`);\n});\n"],"names":["__filename","__dirname","app"],"mappings":"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"}